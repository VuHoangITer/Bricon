{% extends "admin/admin_base.html" %}

{% block title %}Sửa Câu Hỏi{% endblock %}

{% block extra_css %}
<style>
.form-card {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border-radius: 10px;
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <h2 class="mb-4"><i class="bi bi-question-diamond me-2"></i> Sửa Câu Hỏi</h2>

    <div class="card form-card p-4">
        <form method="POST">
            {{ form.hidden_tag() }}

            <div class="mb-3">
                <label class="form-label">{{ form.question_text.label }}</label>
                {{ form.question_text(class="form-control", rows=3) }}
            </div>

            <div class="mb-3">
                <label class="form-label">{{ form.explanation.label }}</label>
                {{ form.explanation(class="form-control", rows=3) }}
            </div>

            <div class="mb-3">
                <label class="form-label">{{ form.points.label }}</label>
                {{ form.points(class="form-control") }}
            </div>

            <div class="mb-3">
                <label class="form-label">Đáp Án (Chọn đúng bằng radio)</label>
                <div id="answers-container">
                    {% for answer in answers %}
                    <div class="input-group mb-2">
                        <input type="radio" name="correct_answer" value="{{ loop.index0 }}" {% if answer.is_correct %}checked{% endif %}>
                        <input type="text" name="answers[]" class="form-control" value="{{ answer.answer_text }}" required>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="btn btn-sm btn-info" onclick="addAnswerField()"><i class="bi bi-plus"></i> Thêm Đáp Án</button>
            </div>

            <div class="d-flex justify-content-end mt-4">
                <a href="{{ url_for('quiz_admin.edit_questions', quiz_id=question.quiz_id) }}" class="btn btn-secondary me-2">Hủy</a>
                <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
        </form>
    </div>
</div>

<script>
function addAnswerField() {
    const container = document.getElementById('answers-container');
    const index = container.children.length;
    const div = document.createElement('div');
    div.className = 'input-group mb-2';
    div.innerHTML = `
        <input type="radio" name="correct_answer" value="${index}">
        <input type="text" name="answers[]" class="form-control" placeholder="Đáp án ${index + 1}" required>
    `;
    container.appendChild(div);
}
</script>
{% endblock %}